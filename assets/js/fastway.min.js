function copy_to_clipboard(idobj) {
    jQuery('#'+idobj).show();
    var copyText = document.getElementById(idobj);

  /* Select the text field */
  copyText.select();

  /* Copy the text inside the text field */
  document.execCommand("copy");

  /* Alert the copied text */
  alert("URL del producto copiada!");
  jQuery('#'+idobj).hide();
}
function remove_item_cart(element) {
   
    var product_id = jQuery('#'+element.id).attr("data-product_id"),
        cart_item_key = jQuery('#'+element.id).attr("data-cart_item_key"),
        product_container = jQuery('#'+element.id).parents('.mini-cart-item');
    product_container.attr("style", "display: none !important");
    jQuery("<div class='loading-div'><img style='margin: 7px 0px 0px 0px;' src='/wp-admin/images/spinner-2x.gif' /></div>").insertBefore(product_container);
    jQuery.ajax({
        type: 'POST',
        dataType: 'json',
        url: wc_add_to_cart_params.ajax_url,
        data: {
            action: "product_remove",
            product_id: product_id,
            cart_item_key: cart_item_key
        },
        success: function(response) {
            if ( ! response || response.error )
                return;
            var fragments = response.fragments;
            // Replace fragments
            if ( fragments ) {
                jQuery.each( fragments, function( key, value ) {
                    jQuery( key ).replaceWith( value );
                });
            }
        }
    });
}

function debounce(func, wait, immediate) {
  var timeout;
  return function() {
    var context = this, args = arguments;
    var later = function() {
      timeout = null;
      if (!immediate) func.apply(context, args);
    };
    var callNow = immediate && !timeout;
    clearTimeout(timeout);
    timeout = setTimeout(later, wait);
    if (callNow) func.apply(context, args);
  };
};
function applySearch(tipo){

  var jQuerysearchWrap = jQuery('.fw_search_form.'+tipo),
      jQuerysearchField = jQuery('.fw_search_form.'+tipo+' .search-field'),
      jQueryloadingIcon = jQuery('.fw_search_form.'+tipo+' .loading'),
      termExists = "";

    // Add results container and disable autocomplete on search field
  jQuerysearchWrap.append('<div class="results"></div>');
  var jQuerysearchResults = jQuery('.fw_search_form.'+tipo+' .results');
  jQuerysearchField.attr('autocomplete', 'off');
  
  // Perform search on keyup in search field, hide/show loading icon
  jQuerysearchField.keyup( function() {
    jQueryloadingIcon.css('display', 'block');
    
    // If the search field is not empty, perform the search function
    if( jQuerysearchField.val() !== "" ) {
      termExists = true;
      doSearch();
    } else {
      termExists = false;
      jQuerysearchResults.empty();
      jQueryloadingIcon.css('display', 'none');
    }
  });
  
  // Make search Ajax request every 200 milliseconds, output results
  var doSearch = debounce(function() {
    var query = jQuerysearchField.val();
    jQuery.ajax({
      type: 'POST',
      url: ajaxurl, // ajaxurl comes from the localize_script we added to functions.php
      data: {
        action: 'ajax_search',
        query: query,
      },
      success: function(result) {
        if ( termExists ) {
          // `result` here is what we've specified in ajax-search.php
          jQuerysearchResults.html('<div class="results-list">' + result + '</div>');
        }
      },
      complete: function() {
        // Whether or not results are returned, hide the loading icon once the request is complete
        jQueryloadingIcon.css('display', 'none');
      }
    });
  }, 200);
}

jQuery(document).on( 'updated_checkout', function(){
  //Actualizo todo pago
  jQuery('.payment_method_todopago label').append('<img src="https://todopago.com.ar/sites/todopago.com.ar/files/boton_192x55_ahora3y6.png" alt="" />')
  
});

jQuery(document).ready( function(jQuery) {
  
  
	applySearch("desktop");
	applySearch("mobile");
	jQuery(document).on('click', '#main-menu .dropdown-menu', function (e) {
		//e.preventDefault();
	  	e.stopPropagation();
	});
	jQuery(document).on('click', '#main-menu-mobile .dropdown-menu', function (e) {
		//e.preventDefault();
	  	e.stopPropagation();
	});
  jQuery(document).on('click', '#page-wrapper', function (e) {
    jQuery('.offcanvas-collapse.open').toggleClass('open');
    jQuery('.menu-madre-mobile').removeClass('opened');
    jQuery('.mobile-menu-overlay').removeClass('opened');
  });
  jQuery('[data-toggle="offcanvas"]').on('click', function () {
    jQuery('.offcanvas-collapse').toggleClass('open');
  });
  jQuery('.btn-bars-mobile').click(function(){
      jQuery('.menu-madre-mobile').addClass('opened');
      jQuery('.mobile-menu-overlay').addClass('opened');
  });    

  jQuery('.mobile-menu-overlay').click(function(){
    jQuery('.menu-madre-mobile').removeClass('opened');
    jQuery('.mobile-menu-overlay').removeClass('opened');
    jQuery('.sidebar-mobile-cats').removeClass('opened');
    });      
jQuery('.btn-bars-mobile-cats').click(function(){

      jQuery('.sidebar-mobile-cats').addClass('opened');
      jQuery('.mobile-menu-overlay').addClass('opened');
  });    
  //var hoverTimeout;
//Megamenu/Desktop
  jQuery('#fw_menu li').hover(function() {
      jQuery(this).find('.dropdown-menu.first').show();
  });
  jQuery('#fw_menu .dropdown-submenu').hover(function() {
    jQuery(this).find('.dropdown-menu.second').show();
  });
  jQuery('#fw_menu li').mouseleave(function() {
    jQuery(this).find('.dropdown-menu.first').hide();
  });
  jQuery('#fw_menu .dropdown-submenu').mouseleave(function() {
    jQuery(this).find('.dropdown-menu.second').hide();
  });
  jQuery('.bottom #fw_menu li.dropdown').hover(function() {
    jQuery('.submenu-overlay').addClass('active');

  });
  jQuery('.bottom #fw_menu li.dropdown').mouseleave(function() {
    jQuery('.submenu-overlay').removeClass('active');

  });

  //Dropdown mpbile
  jQuery('#main-menu-mobile li').click(function() {

    jQuery('.dropdown-menu').hide();
    jQuery(this).find('.dropdown-menu').show();

});
});

jQuery(document).click(function(e) {
  if ((e.target != jQuery('.offcanvas')[0]) && (e.target != jQuery('.offcanvas-toggle')[0]) && (jQuery('body').hasClass('offcanvas-expanded'))) {
    var li_tags = jQuery(jQuery('.offcanvas')[0]).find('li');
    var a_tags = jQuery(jQuery('.offcanvas')[0]).find('a');
    for (var i = 0; i < li_tags.length; i++) {
      if (e.target == li_tags[i] || e.target == a_tags[i]) {
        return;
      }
    }
    jQuery('.offcanvas-collapse').toggleClass('open');
  }
  
});

if (jQuery('#back-to-top').length) {
    var scrollTrigger = 100, // px
        backToTop = function () {
            var scrollTop = jQuery(window).scrollTop();
            if (scrollTop > scrollTrigger) {
                jQuery('#back-to-top').addClass('show');
            } else {
                jQuery('#back-to-top').removeClass('show');
            }
        };
    backToTop();
    jQuery(window).on('scroll', function () {
        backToTop();
    });
    jQuery('#back-to-top').on('click', function (e) {
        e.preventDefault();
        jQuery('html,body').animate({
            scrollTop: 0
        }, 700);
    });
}



/*VARIABLE PRODUCTS*/
if (jQuery('form.variations_form').length !== 0) {
  var form = jQuery('form.variations_form');
  var variable_product_price = '';
  setInterval(function() {
      
      if (jQuery('.single_variation_wrap span.price').length !== 0) {
        if (jQuery('.single_variation_wrap span.price').text() !== variable_product_price) {
              variable_product_price = jQuery('.single_variation_wrap span.price');
              console.log(variable_product_price)
              jQuery('.fw_single_product .summary span.price').append(variable_product_price);
          }
      }
  }, 500);
}

jQuery(window).scroll(function(){
  var jQueryaltoScroll = jQuery('.fw_single_product').height() - 350;
  if (jQuery(this).scrollTop() > jQueryaltoScroll) {
      jQuery('.fw_single_product .summary').toggleClass('fixed');
  }            
});    