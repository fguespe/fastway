!function(e){"use strict";function t(i,n){var s=this;this.$element=e(i),this.options=e.extend(!0,{},t.defaults,n),this._items=e(),Object.defineProperties(this,{itemsSelector:{get:function(){return s.options.classMap.hasSubMenu+","+s.options.classMap.hasMegaMenu}},_tempChain:{value:null,writable:!0},state:{value:null,writable:!0}}),this.initialize()}function i(e,t,i,n){var s=this;this.$element=e,this.menu=t,this.options=i,this.$container=n,Object.defineProperties(this,{itemClass:{get:function(){return"mega-menu"===s.options.type?s.options.classMap.hasMegaMenu:s.options.classMap.hasSubMenu}},activeItemClass:{get:function(){return"mega-menu"===s.options.type?s.options.classMap.hasMegaMenuActive:s.options.classMap.hasSubMenuActive}},menuClass:{get:function(){return"mega-menu"===s.options.type?s.options.classMap.megaMenu:s.options.classMap.subMenu}},isOpened:{get:function(){return this.$element.hasClass(this.activeItemClass.slice(1))}}}),this.menu.addClass("animated").on("click.HSMegaMenu",function(e){s._updateMenuBounds()}),this.$element.data("max-width")&&this.menu.css("max-width",this.$element.data("max-width")),this.$element.data("position")&&this.menu.addClass("hs-position-"+this.$element.data("position")),this.options.animationOut&&this.menu.on("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(e){s.menu.hasClass(s.options.animationOut)&&(s.$element.removeClass(s.activeItemClass.slice(1)),s.options.afterClose.call(s,s.$element,s.menu)),s.menu.hasClass(s.options.animationIn)&&s.options.afterOpen.call(s,s.$element,s.menu),e.stopPropagation(),e.preventDefault()})}function n(){return"ontouchstart"in window}t.defaults={event:"hover",direction:"horizontal",breakpoint:991,animationIn:!1,animationOut:!1,rtl:!1,hideTimeOut:300,sideBarRatio:.25,pageContainer:e("body"),classMap:{initialized:".hs-menu-initialized",mobileState:".hs-mobile-state",subMenu:".hs-sub-menu",hasSubMenu:".hs-has-sub-menu",hasSubMenuActive:".hs-sub-menu-opened",megaMenu:".hs-mega-menu",hasMegaMenu:".hs-has-mega-menu",hasMegaMenuActive:".hs-mega-menu-opened"},mobileSpeed:400,mobileEasing:"linear",beforeOpen:function(){},beforeClose:function(){},afterOpen:function(){},afterClose:function(){}},t.prototype.initialize=function(){var t=this,i=e(window);return this.options.rtl&&this.$element.addClass("hs-rtl"),this.$element.addClass(this.options.classMap.initialized.slice(1)).addClass("hs-menu-"+this.options.direction),i.on("resize.HSMegaMenu",function(e){t.resizeTimeOutId&&clearTimeout(t.resizeTimeOutId),t.resizeTimeOutId=setTimeout(function(){window.innerWidth<=t.options.breakpoint&&"desktop"==t.state?t.initMobileBehavior():window.innerWidth>t.options.breakpoint&&"mobile"==t.state&&t.initDesktopBehavior(),t.refresh()},50)}),e(document).on("click.HSMegaMenu",function(i){var n=e(i.target).parents(t.itemsSelector);t.closeAll(n.add(e(i.target)))}).on("keyup.HSMegaMenu",function(e){e.keyCode&&27==e.keyCode&&t.closeAll()}),window.innerWidth<=this.options.breakpoint?this.initMobileBehavior():window.innerWidth>this.options.breakpoint&&this.initDesktopBehavior(),this.smartPositions(),this},t.prototype.smartPositions=function(){var t=this;this.$element.find(this.options.classMap.subMenu).each(function(n,s){i.smartPosition(e(s),t.options)})},t.prototype.bindEvents=function(){var t=this;"hover"!==this.options.event||n()?(this.$element.on("click.HSMegaMenu",n()?this.options.classMap.hasMegaMenu+" > a, "+this.options.classMap.hasSubMenu+" > a":this.options.classMap.hasMegaMenu+':not([data-event="hover"]) > a,'+this.options.classMap.hasSubMenu+':not([data-event="hover"]) > a',function(i){var n,s=e(this).parent();s.parents(t.itemsSelector);s.data("HSMenuItem")||t.initMenuItem(s,t.getType(s)),t.closeAll(s.add(s.parents(t.itemsSelector))),(n=s.addClass("hs-event-prevented").data("HSMenuItem")).isOpened?n.hide():n.show(),i.preventDefault(),i.stopPropagation()}),n()||this.$element.on("mouseenter.HSMegaMenu",this.options.classMap.hasMegaMenu+'[data-event="hover"],'+this.options.classMap.hasSubMenu+'[data-event="hover"]',function(i){var n=e(this),s=n.parents(t.itemsSelector);n.data("HSMenuItem")||t.initMenuItem(n,t.getType(n)),t.closeAll(n.add(s)),s.add(n).each(function(t,i){var n=e(i).data("HSMenuItem");n.hideTimeOutId&&clearTimeout(n.hideTimeOutId),n.show()}),i.preventDefault(),i.stopPropagation()}).on("mouseleave.HSMegaMenu",this.options.classMap.hasMegaMenu+'[data-event="hover"],'+this.options.classMap.hasSubMenu+'[data-event="hover"]',function(i){e(this).data("HSMenuItem").hideTimeOutId=setTimeout(function(){t.closeAll(e(i.relatedTarget).parents(t.itemsSelector))},t.options.hideTimeOut),i.preventDefault(),i.stopPropagation()})):this.$element.on("mouseenter.HSMegaMenu",this.options.classMap.hasMegaMenu+':not([data-event="click"]),'+this.options.classMap.hasSubMenu+':not([data-event="click"])',function(i){var n=e(this),s=n.parents(t.itemsSelector);n.data("HSMenuItem")||t.initMenuItem(n,t.getType(n)),s=s.add(n),t.closeAll(s),s.each(function(t,i){var n=e(i).data("HSMenuItem");n.hideTimeOutId&&clearTimeout(n.hideTimeOutId),n.show()}),t._items=t._items.not(s),t._tempChain=s,i.preventDefault(),i.stopPropagation()}).on("mouseleave.HSMegaMenu",this.options.classMap.hasMegaMenu+':not([data-event="click"]),'+this.options.classMap.hasSubMenu+':not([data-event="click"])',function(i){var n=e(this).data("HSMenuItem"),s=e(i.relatedTarget).parents(t.itemsSelector);n.hideTimeOutId=setTimeout(function(){t.closeAll(s)},t.options.hideTimeOut),t._items=t._items.add(t._tempChain),t._tempChain=null,i.preventDefault(),i.stopPropagation()}).on("click.HSMegaMenu",this.options.classMap.hasMegaMenu+'[data-event="click"] > a, '+this.options.classMap.hasSubMenu+'[data-event="click"] > a',function(i){var n,s=e(this).parent('[data-event="click"]');s.data("HSMenuItem")||t.initMenuItem(s,t.getType(s)),t.closeAll(s.add(s.parents(t.itemsSelector))),(n=s.data("HSMenuItem")).isOpened?n.hide():n.show(),i.preventDefault(),i.stopPropagation()})},t.prototype.initMenuItem=function(t,n){var s=new i(t,t.children(this.options.classMap["mega-menu"===n?"megaMenu":"subMenu"]),e.extend(!0,{type:n},this.options,t.data()),this.$element);t.data("HSMenuItem",s),this._items=this._items.add(t)},t.prototype.initMobileBehavior=function(){var t=this;this.state="mobile",this.$element.off(".HSMegaMenu").addClass(this.options.classMap.mobileState.slice(1)).on("click.HSMegaMenu",t.options.classMap.hasSubMenu+" > a, "+t.options.classMap.hasMegaMenu+" > a",function(i){var n,s=e(this).parent();s.data("HSMenuItem")||t.initMenuItem(s,t.getType(s)),t.closeAll(s.parents(t.itemsSelector).add(s)),n=s.data("HSMenuItem"),console.log(n.isOpened),n.isOpened?n.mobileHide():n.mobileShow(),i.preventDefault(),i.stopPropagation()}).find(this.itemsSelector).not(this.options.classMap.hasSubMenuActive+","+this.options.classMap.hasMegaMenuActive).children(this.options.classMap.subMenu+","+this.options.classMap.megaMenu).hide()},t.prototype.initDesktopBehavior=function(){this.state="desktop",this.$element.removeClass(this.options.classMap.mobileState.slice(1)).off(".HSMegaMenu").find(this.itemsSelector).not(this.options.classMap.hasSubMenuActive+","+this.options.classMap.hasMegaMenuActive).children(this.options.classMap.subMenu+","+this.options.classMap.megaMenu).hide(),this.bindEvents()},t.prototype.closeAll=function(t){var i=this;return this._items.not(t&&t.length?t:e()).each(function(t,n){e(n).removeClass("hs-event-prevented").data("HSMenuItem")["mobile"==i.state?"mobileHide":"hide"]()})},t.prototype.getType=function(e){return e&&e.length?e.hasClass(this.options.classMap.hasSubMenu.slice(1))?"sub-menu":e.hasClass(this.options.classMap.hasMegaMenu.slice(1))?"mega-menu":null:null},t.prototype.getState=function(){return this.state},t.prototype.refresh=function(){return this._items.add(this._tempChain).each(function(t,i){e(i).data("HSMenuItem")._updateMenuBounds()})},i.prototype.show=function(){return this.menu.length?(this.$element.addClass(this.activeItemClass.slice(1)),"horizontal"==this.options.direction&&this.smartPosition(this.menu,this.options),this._updateMenuBounds(),this.options.animationOut?this.menu.removeClass(this.options.animationOut):this.options.afterOpen.call(this,this.$element,this.menu),this.options.animationIn&&this.menu.addClass(this.options.animationIn),this):this},i.prototype.hide=function(){return this.menu.length?(this.options.animationOut||this.$element.removeClass(this.activeItemClass.slice(1)),this.options.animationIn&&this.menu.removeClass(this.options.animationIn),this.options.animationOut?this.menu.addClass(this.options.animationOut):this.options.afterClose.call(this,this.$element,this.menu),this):this},i.prototype.mobileShow=function(){var e=this;return this.menu.length?(this.menu.removeClass(this.options.animationIn).removeClass(this.options.animationOut).stop().slideDown({duration:e.options.mobileSpeed,easing:e.options.mobileEasing,complete:function(){e.options.afterOpen.call(e,e.$element,e.menu)}}),this.$element.addClass(this.activeItemClass.slice(1)),this):this},i.prototype.mobileHide=function(){var e=this;return this.menu.length?(this.menu.stop().slideUp({duration:e.options.mobileSpeed,easing:e.options.mobileEasing,complete:function(){e.options.afterClose.call(e,e.$element,e.menu)}}),this.$element.removeClass(this.activeItemClass.slice(1)),this):this},i.prototype.smartPosition=function(e,t){i.smartPosition(e,t)},i.smartPosition=function(t,i){if(t||t.length){e(window);t.removeClass("hs-reversed"),i.rtl?t.offset().left<0&&t.addClass("hs-reversed"):t.offset().left+t.outerWidth()>window.innerWidth&&t.addClass("hs-reversed")}},i.prototype._updateMenuBounds=function(){var t="auto";if("vertical"==this.options.direction&&"mega-menu"==this.options.type){if(this.$container&&"desktop"==this.$container.data("HSMegaMenu").getState()?(this.options.pageContainer.length||(this.options.pageContainer=e("body")),t=this.options.pageContainer.outerWidth()*(1-this.options.sideBarRatio)):t="auto",this.menu.css({width:t,height:"auto"}),this.menu.outerHeight()>this.$container.outerHeight())return;this.menu.css("height","100%")}},e.fn.HSMegaMenu=function(i){return this.each(function(n,s){var a=e(this);a.data("HSMegaMenu")||a.data("HSMegaMenu",new t(a,i))})}}(jQuery);